# ic_blocks_divider
Программа предназначена для разбиения интегральных схем, описываемых файлами формата *.cif*, на блоки.

_______

**Использование**

Файлы *.cif*-формата - это специальные файлы для описания интегральных схем в виде набора геометрических фигур, представляющих собой атомные слои того или иного материала.

Иногда может потребоваться выделить некоторые блоки (части схемы) из уже описанных готовых схем, например, для их подробного разбора и анализа. Но схемы могут содержать в себе очень много элементов, и самих блоков может понадобиться немало, поэтому процесс разбиения схемы на блоки лучше автоматизировать.

Данная программа как раз и предназначена для автоматизации процесса выделения блоков из *.cif*-файлов.

Блочные границы должны быть обозначены пользователем таким образом, чтобы набор блоков представлял собой матрицу вида *N*x*M*. То есть, перед использованием программы пользователь должен самостоятельно расчертить файл сеткой с прямоугольными ячейками произвольных размеров. Проделать это можно в любом доступном редакторе *.cif*-файлов.

Сетка должна представлять собой набор пересекающихся вертикальных и горизонтальных шин специальных типов **B1** и **B2**. Они, в отличие от других типов в *.cif*-файлах, не обозначают материал, а являются служебными описательными типами, как раз подходящими для разметки границ блоков на схеме.

После того, как исходный *.cif*-файл описания интегральной схемы размечен в соответствии с приведёнными выше правилами, можно применять к нему данную программу.

_______

**Описание работы**

Программа ищет в тексте исходного *.cif*-файла все вертикальные и горизонтальные шины типов **B1** и **B2**. Затем сортирует горизонтали по координате *y* по возрастанию, а вертикали - по координате *x* также по возрастанию.

Таким образом программа находит и распознаёт сетку, которой схема была расчерчена на блоки. Затем осуществляется проход по блокам сетки. В зависимости от выбранной опции фигуры, входящие в очередной блок, либо обрезаются (до границы блока или с выступом на четверть от максимального заступа за границу), либо оставляются как есть. Координаты очередного блока пересчитываются так, как если бы он начинался в точке *(0, 0)*.

Блоки записываются в один или в несколько разных выходных *.cif*-файлов в зависимости от выбранной опции. Для каждого блока пишется *cif*-комментарий, говорящий о том, на какие координаты его надо сместить относительно точки *(0, 0)*, чтобы получить его фактическую позицию в исходном файле.

_______

**Выдаваемые результаты**

На выход программа выдаёт *N\*M* блоков, "вырванных" из исходной схемы, расчерченной сеткой размера *N*x*M*. Координаты каждого блока пересчитываются по начальной координате *(0, 0)*. Помимо этого, в консоль дополнительно выводится время, затраченное программой.

_______

**Варианты работы**

Программа работает от настроечного файла *Settings.txt*, который должен лежать в одной папке с исполняемым jar-файлом. Помимо пути к исходному файлу со схемой и пути к папке, в которую должны быть помещены выходные файлы с блоками, настроечный файл даёт возможность также задать следующие опции:

- записывать ли все *N\*M* блоков в один файл или в *N\*M* разных файлов соответственно;
- обрезать ли фигуры, которые выходят за края блока, или нет;
- обрезать ли фигуры полностью до границы блока или сделать выступ на четверть от максимального заступа за границу.

Третья опция задаётся только в том случае, если во второй был выбран вариант "обрезать фигуры". Эти опции делают программу очень гибкой, так как в разных случаях могут понадобиться разные варианты разбиения схемы на блоки. При этом если был выбран вариант того или иного обрезания фигур, программа будет работать ощутимо дольше, так как как затратит много времени на дополнительные действия, связанные с усечением фигур.

_______

**Ограничения в работе**

1) Программа не способна парсить некоторые синтаксические возможности *.cif*-файлов. Например, она не распознаёт вставку ячеек в ячейки в виде вызова функции.
2) Программа работает с тем предположением, что все фигуры являются многоугольниками с вертикальными и горизонтальными сторонами.
3) Программа может по-разному отрабатывать в тех случаях, когда фигуры своими границами лежат на границах блоков.

За счёт этого приложение покрывает не все возможные варианты исходных схем, но зато в рамках тех, для которых оно отрабатывает корректно, всё равно представляет хорошую альтернативу ручному выделению блоков, особенно с учётом потенциальной возможности обрезки входящих в блоки фигур.
